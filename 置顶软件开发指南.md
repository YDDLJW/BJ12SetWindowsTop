# 置顶软件开发指南

## 基本功能

置顶一个或多个指定窗口，并在被置顶的窗口上方播放动画小人，同时可以为每个窗口记录笔记。

## 安装环境

### 安装python依赖

- python版本要求：3.10, 3.11, 3.12
- 在命令行运行以下命令安装所有依赖
    ```bash
    pip install -r requirements.txt
    ```

## 前端

- 单击或右键任务栏小图标打开任务栏窗口
- 打开程序时或者双击任务栏小图标时打开总览图形界面
- 窗口被置顶时根据该窗口位置播放动画

### 1. 任务栏窗口

#### 按钮

- 打开总览界面按钮
- 列出当前所有窗口列表（调用后端API获取该列表）
- 暂停/继续所有窗口置顶按钮(该窗口一行右侧有一个√表示已置顶)
- 退出程序按钮

#### 功能

- 点击指定窗口名称置顶该窗口（调用后端API返回窗口名称）
- 点击总览界面按钮打开总览图型界面
- 点击暂停/继续按钮暂停或继续置顶功能（调用后端API返回窗口名称进行置顶与暂停置顶）
- 退出程序

### 2. 总览图形界面

- 列出一个列表，包含当前所有窗口名称，是否被置顶（调用后端API获取该列表）
- 在上述列表下列出另外一个列表，列出当前未打开但曾经打开过的窗口的名称（调用后端API获取该列表）
- 通过上述列表点击特定窗口，打开包含其笔记内容的界面，可以进行编辑（调用后端API获取对应的窗口信息和笔记内容）

### 3. 播放动画

- 当有窗口被置顶时，在该窗口上特定位置播放动画
- 连续播放一个特定文件夹内的多个图片组成动画
- 该动画要求在屏幕的指定位置播放，即固定在该置顶窗口的边缘
- 该动画播放的位置可以实时变化
- 该动画播放的位置根据窗口的移动而移动，默认出现在窗口的左上角
- 可以通过拖动来修改动画在窗口边缘的相对位置（如可从窗口左上角拖动到窗口右上角）
- 点击该动画会打开一个和该动画有同样行动模式的文本框（即同样跟随窗口移动）（打开时调用后端API获取该窗口的笔记内容）（没有变化后n秒将笔记内容post到后端API）
- 打开文本框时，再次点击动画会关闭文本框
- 文本框应该有一个最小大小，同时会根据文本内容动态调节大小，大小应尽可能小

## 后端

- 开发语言：Python 3.12.0
- ~~工具包：Django5.0, Django REST framework~~
- 数据库：Sqlite3

### 1. 数据库

注意：下列表中的字段包含一个自动生成并自增长的id字段
- 表1：current_windows
  - 字段：
    - 窗口名称(text)(name)
    - 窗口句柄(text)(hwnd)
    - 是否被置顶(bool)(is_set_top)
    - 窗口笔记(text)(notes)
  - 在每次启动软件时新建该表，即在启动时和关闭时删除之前所有信息。
  - 窗口句柄(hwnd)字段为唯一
- 表2：all_windows
  - 字段：
    - 窗口名称(text)(name)
    - 日期(text)(date)
    - 窗口笔记(text)(notes)
  - 该表信息一直存在，不随软件开启或关闭变化。
  - 日期(date)字段将自动更新，在post时无需发送该字段

### 2. 功能

#### 操作窗口

- 动态获取当前所有窗口信息列表（窗口名称，句柄）
- 动态监测数据库，通过句柄置顶或取消置顶指定窗口
- 开关取消所有窗口的置顶

#### 操作数据库

- 动态将当前所有窗口信息存入数据库（窗口名称，句柄）
  - ~~如发现窗口名称相同，则不更新all_windows表~~
- 根据前端返回的信息（笔记内容）对数据库进行修改

#### API开发

- [详见API使用&开发指南.md]()
